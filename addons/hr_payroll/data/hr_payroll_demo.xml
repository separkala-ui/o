<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <record id="base.user_demo" model="res.users">
            <field name="group_ids" eval="[
                (3, ref('hr.group_hr_user')),
                (3, ref('hr.group_hr_manager')),
                (3, ref('hr_payroll.group_hr_payroll_user')), 
                (3, ref('hr_payroll.group_hr_payroll_manager'))]"/>
        </record>

        <record id="base.default_user_group" model="res.groups">
            <field name="implied_ids" eval="[(4, ref('hr_payroll.group_hr_payroll_manager'))]"/>
        </record>
    </data>

    <data noupdate="0">
        <!-- Structure Type -->
        <record id="hr.structure_type_worker" model="hr.payroll.structure.type">
            <field name="wage_type">hourly</field>
        </record>

        <!-- Contribution Register -->
        <record id="hr_houserent_register" model="res.partner">
            <field name="name">House Rent Allowance Register</field>
            <field name="is_company">1</field>
        </record>

        <record id="hr_provident_fund_register" model="res.partner">
            <field name="name">Provident Fund Register</field>
        </record>

        <record id="hr_professional_tax_register" model="res.partner">
            <field name="name">Professional Tax Register</field>
        </record>

        <record id="hr_meal_voucher_register" model="res.partner">
            <field name="name">Meal Voucher Register</field>
            <field name="company_type">company</field>
        </record>

        <!-- Salary Rules for Regular Pay-->

        <record id="structure_003" model="hr.payroll.structure">
            <field name="name">13th month - End of the year bonus</field>
            <field name="type_id" ref="hr.structure_type_employee"/>
            <field name="rule_ids" eval="[]"/>
        </record>

        <record id="hr_salary_rule_houserentallowance1" model="hr.salary.rule">
            <field name="amount_select">percentage</field>
            <field eval="40.0" name="amount_percentage"/>
            <field name="amount_percentage_base">version.wage</field>
            <field name="code">HRA</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="partner_id" ref="hr_houserent_register"/>
            <field name="name">House Rent Allowance</field>
            <field name="sequence" eval="5"/>
            <field name="struct_id" ref="structure_002"/>
        </record>

        <record id="hr_salary_rule_convanceallowance1" model="hr.salary.rule">
            <field name="amount_select">fix</field>
            <field eval="800.0" name="amount_fix"/>
            <field name="code">CA</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Conveyance Allowance</field>
            <field name="sequence" eval="10"/>
            <field name="struct_id" ref="structure_002"/>
        </record>

        <record id="hr_salary_rule_ca_gravie" model="hr.salary.rule">
            <field name="amount_select">fix</field>
            <field name="amount_fix" eval="600.0"/>
            <field name="code">CAGG</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Conveyance Allowance For Gravie</field>
            <field name="sequence" eval="15"/>
            <field name="struct_id" ref="structure_002"/>
        </record>

        <record id="hr_salary_rule_sum_alw_category" model="hr.salary.rule">
            <field name="amount_select">code</field>
            <field name="code">SUMALW</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Sum of Allowance category</field>
            <field name="sequence" eval="99"/>
            <field name="amount_python_compute">result = payslip._sum_category('ALW', payslip.date_from, to_date=payslip.date_to)</field>
            <field name="struct_id" ref="structure_002"/>
         </record>

        <record id="hr_salary_rule_meal_voucher" model="hr.salary.rule">
            <field name="amount_select">fix</field>
            <field eval="10" name="amount_fix"/>
            <field name="quantity">'WORK100' in worked_days and worked_days['WORK100'].number_of_days</field>
            <field name="code">MA</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="partner_id" ref="hr_meal_voucher_register"/>
            <field name="name">Meal Voucher</field>
            <field name="sequence" eval="16"/>
            <field name="struct_id" ref="structure_002"/>
         </record>

        <record id="hr_salary_rule_providentfund1" model="hr.salary.rule">
            <field name="amount_select">percentage</field>
            <field name="sequence" eval="120"/>
            <field name="amount_percentage" eval="-12.5"/>
            <field name="amount_percentage_base">version.wage</field>
            <field name="code">PF</field>
            <field name="category_id" ref="hr_payroll.DED"/>
            <field name="partner_id" ref="hr_provident_fund_register"/>
            <field name="name">Provident Fund</field>
            <field name="struct_id" ref="structure_002"/>
        </record>

        <record id="hr_salary_rule_professionaltax1" model="hr.salary.rule">
            <field name="amount_select">fix</field>
            <field name="sequence" eval="150"/>
            <field name="amount_fix" eval="-200.0"/>
            <field name="code">PT</field>
            <field name="category_id" ref="hr_payroll.DED"/>
            <field name="partner_id" ref="hr_professional_tax_register"/>
            <field name="name">Professional Tax</field>
            <field name="struct_id" ref="structure_002"/>
        </record>

        <record id="hr_salary_rule_13th_month_salary" model="hr.salary.rule">
            <field name="amount_select">percentage</field>
            <field name="amount_percentage" eval="10.0"/>
            <field name="amount_percentage_base">version.wage</field>
            <field name="code">13th pay</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">13th pay salary</field>
            <field name="sequence" eval="5"/>
            <field name="struct_id" ref="structure_003"/>
        </record>

        <!-- Employee -->

        <record id="hr_employee_payroll" model="hr.employee">
            <field name="company_id" ref="base.main_company"/>
            <field eval="1" name="active"/>
            <field name="name">Roger Scott</field>
            <field name="job_id" ref="hr.job_developer"/>
            <field name="department_id" ref="hr.dep_rd_be"/>
            <field name="sex">male</field>
            <field name="parent_id" ref="hr.employee_vad"/>
            <field name="work_location_id" ref="hr.work_location_1"/>
            <field name="work_phone">+3282823500</field>
            <field name="image_1920" type="base64" file="hr_payroll/static/img/hr_employee_payroll-image.jpg"/>
            <field name="date_version" eval="time.strftime('%Y-%m')+'-1'"/>
            <field name="contract_date_start" eval="time.strftime('%Y-%m')+'-1'"/>
            <field name="contract_date_end" eval="time.strftime('%Y')+'-12-31'"/>
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
            <field eval="4000.0" name="wage"/>
            <field name="hr_responsible_id" ref="base.user_admin"/>
        </record>

        <!-- Employee Contract -->

        <record id="hr.employee_admin" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_al" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_mit" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_stw" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_qdp" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_han" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_niv" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_jth" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_chs" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_jve" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_fme" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_fpi" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <record id="hr.employee_vad" model="hr.employee">
            <field name="structure_type_id" ref="hr.structure_type_employee"/>
        </record>

        <!-- Salary Attachments -->
        <record id="child_support" model="hr.salary.attachment">
            <field name="employee_ids" eval="[(4, ref('hr.employee_qdp'))]"/>
            <field name="monthly_amount">7500</field>
            <field name="other_input_type_id" ref="hr_payroll.input_child_support"/>
            <field name="date_start" eval="DateTime.today()"/>
            <field name="description">Child Support</field>
        </record>

        <!-- Work entries -->
        <record id="hr_work_entry.work_entry_type_long_leave" model="hr.work.entry.type">
            <field name="is_leave">True</field>
            <field name="round_days">FULL</field>
            <field name="round_days_type">DOWN</field>
        </record>

        <function model="hr.employee" name="generate_work_entries">
            <value model="hr.employee" eval="obj().search([]).ids"/>
            <value eval="(DateTime.today() + relativedelta(day=1, months=-1))"/>
            <value eval="(DateTime.today() + relativedelta(day=31))"/>
        </function>

        <!-- Payslip batch Year -1 -->
        <record id="hr_payslip_batch_year_1" model="hr.payslip.run">
            <field name="name" eval="'Late batch salary ' + (DateTime.today() - relativedelta(years=1, month=1, day=1)).strftime('%B %Y')"/>
            <field name="date_start" eval="(DateTime.today() - relativedelta(years=1, month=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_end" eval="(DateTime.today() - relativedelta(years=1, month=2, day=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslip batch Year -2 -->
        <record id="hr_payslip_batch_year_2" model="hr.payslip.run">
            <field name="name" eval="(DateTime.today() - relativedelta(years=2, month=1, day=1)).strftime('%B %Y') + ' batch'"/>
            <field name="date_start" eval="(DateTime.today() - relativedelta(years=2) + relativedelta(day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_end" eval="(DateTime.today() - relativedelta(years=2) + relativedelta(months=12, day=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslip batch Month 0-->
        <record id="hr_payslip_batch_latest" model="hr.payslip.run">
            <field name="name" eval="'Batch for ' + time.strftime('%B %Y')"/>
            <field name="date_start" eval="time.strftime('%Y-%m-1')"/>
            <field name="date_end" eval="(DateTime.today() + relativedelta(months=1, day=1) - relativedelta(days=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <record id="hr_payslip_batch_new_batch" model="hr.payslip.run">
            <field name="name" eval="'Correction batch for ' + (DateTime.today() - relativedelta(day=1)).strftime('%B %Y')"></field>
            <field name="date_start" eval="(DateTime.today() - relativedelta(day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_end" eval="(DateTime.today() + relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslips Batch Month - 1 -->
        <record id="hr_payslip_batch_month_1" model="hr.payslip.run">
            <field name="name" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%B %Y')"/>
            <field name="date_start" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_end" eval="(DateTime.today() - relativedelta(day=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslip Batch Month - 2 -->
        <record id="hr_payslip_batch_month_2" model="hr.payslip.run">
            <field name="name" eval="'Pay of the month ' + (DateTime.today() - relativedelta(months=2, day=1)).strftime('%B %Y')"/>
            <field name="date_start" eval="(DateTime.today() - relativedelta(months=2, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_end" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslip Admin  -->
        <record id="hr_payslip_admin_latest_0" model="hr.payslip">
            <field name="name" eval="'Mitchell Admin 1 ' + time.strftime('%B %Y')"/>
            <field name="date_from" eval="time.strftime('%Y-%m-1')"/>
            <field name="date_to" eval="(DateTime.today() + relativedelta(months=1, day=1) - relativedelta(days=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_latest"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <record id="hr_payslip_admin_latest_1" model="hr.payslip">
            <field name="name" eval="'Mitchell Admin 2 ' + time.strftime('%B %Y')"/>
            <field name="date_from" eval="time.strftime('%Y-%m-1')"/>
            <field name="date_to" eval="(DateTime.today() + relativedelta(months=1, day=1) - relativedelta(days=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_latest"/>
            <field name="company_id" ref="base.main_company"/>
            <field name="version_id" model="hr.employee" eval="obj(ref('hr.employee_admin'))._get_version(time.strftime('%Y-%m-16'))"/>
        </record>

        <record id="hr_payslip_admin_month_1" model="hr.payslip">
            <field name="name" eval="'Mitchell Admin ' + (DateTime.today() - relativedelta(months=1, day=1)).strftime('%B %Y')"/>
            <field name="date_from" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_to" eval="(DateTime.today() - relativedelta(day=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_month_1"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <record id="hr_payslip_admin_month_1_1" model="hr.payslip">
            <field name="name" eval="'Mitchell Admin ' + (DateTime.today() - relativedelta(months=1, day=1)).strftime('%B %Y')"/>
            <field name="date_from" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_to" eval="(DateTime.today() - relativedelta(day=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_month_1"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <record id="hr_payslip_admin_month_2" model="hr.payslip">
            <field name="name" eval="'Mitchell Admin ' + (DateTime.today() - relativedelta(months=2, day=1)).strftime('%B %Y')"/>
            <field name="date_from" eval="(DateTime.today() - relativedelta(months=2, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_to" eval="(DateTime.today() - relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_month_2"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Payslip Demo  -->
        <record id="hr_payslip_demo_latest" model="hr.payslip">
            <field name="name" eval="'Marc Demo ' + time.strftime('%B %Y')"/>
            <field name="date_from" eval="time.strftime('%Y-%m-1')"/>
            <field name="date_to" eval="(DateTime.today() + relativedelta(months=1, day=1) - relativedelta(days=1)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_qdp"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_latest"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Year Payslips -->
        <record id="hr_payslip_admin_year_1" model="hr.payslip">
            <field name="name">Mitchell Admin Long Payslip</field>
            <field name="date_from" eval="(DateTime.today() + relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_to" eval="(DateTime.today() + relativedelta(months=1, day=30)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_admin"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_year_1"/>
            <field name="company_id" ref="base.main_company"/>
            <field name="version_id" model="hr.employee" eval="obj(ref('hr.employee_admin'))._get_version(time.strftime('%Y-%m-16'))"/>
        </record>

        <record id="hr_payslip_demo_year_2" model="hr.payslip">
            <field name="name">Marc Demo Long Payslip</field>
            <field name="date_from" eval="(DateTime.today() + relativedelta(months=1, day=1)).strftime('%Y-%m-%d')"/>
            <field name="date_to" eval="(DateTime.today() + relativedelta(months=1, day=30)).strftime('%Y-%m-%d')"/>
            <field name="employee_id" ref="hr.employee_qdp"/>
            <field name="struct_id" ref="hr_payroll.structure_002"/>
            <field name="payslip_run_id" ref="hr_payslip_batch_year_2"/>
            <field name="company_id" ref="base.main_company"/>
        </record>

        <!-- Compute Sheets -->
        <function model="hr.payslip" name="compute_sheet">
            <value model="hr.payslip" eval="[
                ref('hr_payslip_admin_latest_0'),
                ref('hr_payslip_admin_latest_1'),
                ref('hr_payslip_demo_latest'),
                ref('hr_payslip_admin_month_1'),
                ref('hr_payslip_admin_month_2'),
                ref('hr_payslip_admin_month_1_1'),
                ref('hr_payslip_admin_year_1'),
                ref('hr_payslip_demo_year_2')
                ]"/>
        </function>

        <!-- Validate Batch -->
        <function model="hr.payslip.run" name="action_validate">
            <value model="hr.payslip.run" eval="[ref('hr_payslip_batch_month_1'), ref('hr_payslip_batch_month_2')]"/>
        </function>

        <!-- Set batch to paid -->
        <function model="hr.payslip.run" name="action_paid">
            <value model="hr.payslip.run" eval="[ref('hr_payslip_batch_month_2')]"/>
        </function>
    </data>
</odoo>

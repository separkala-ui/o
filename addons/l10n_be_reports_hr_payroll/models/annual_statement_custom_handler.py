from odoo import models


class AnnualStatementReportHandler(models.AbstractModel):
    _name = 'annual.statement.report.handler'
    _inherit = ['annual.statement.report.handler']

    def _get_extra_file_data(self, options):
        super_data = super()._get_extra_file_data(options)

        sbs_data = self.env['l10n.be.social.balance.sheet'].create({
            'company_id': self.env.company.id,
            'date_from': options['date']['date_from'],
            'date_to': options['date']['date_to'],
        })._get_report_data().get('social_balance_sheet')

        if not sbs_data:
            return super_data

        cost_full_time = sbs_data['102']['total']['male']['full'] + sbs_data['102']['total']['female']['full']
        cost_part_time = sbs_data['102']['total']['male']['part'] + sbs_data['102']['total']['female']['part']

        return {
            **super_data,
            'with_social_balance_sheet': True,
            'BE_SBS_1001_TOTAL': round(sbs_data['1001_total'], 1),
            'BE_SBS_1002_TOTAL': round(sbs_data['1002_total'], 1),
            'BE_SBS_1003_TOTAL': round(sbs_data['1003_total'], 1),
            'BE_SBS_1011_TOTAL': round(sbs_data['1011_total']),
            'BE_SBS_1012_TOTAL': round(sbs_data['1012_total']),
            'BE_SBS_1013_TOTAL': round(sbs_data['1013_total']),
            'BE_SBS_1021_TOTAL': round(cost_full_time, 2),
            'BE_SBS_1022_TOTAL': round(cost_part_time, 2),
            'BE_SBS_1023_TOTAL': round(cost_full_time + cost_part_time, 2),
            'BE_SBS_105_FT': int(sbs_data['105']['full']),
            'BE_SBS_105_PT': int(sbs_data['105']['part']),
            'BE_SBS_105_FTE': round(sbs_data['105']['fte'], 1),
            'BE_SBS_110_FT': int(sbs_data['110']['full']),
            'BE_SBS_110_PT': int(sbs_data['110']['part']),
            'BE_SBS_110_FTE': round(sbs_data['110']['fte'], 1),
            'BE_SBS_111_FT': int(sbs_data['111']['full']),
            'BE_SBS_111_PT': int(sbs_data['111']['part']),
            'BE_SBS_111_FTE': round(sbs_data['111']['fte'], 1),
            'BE_SBS_112_FT': int(sbs_data['112']['full']),
            'BE_SBS_112_PT': int(sbs_data['112']['part']),
            'BE_SBS_112_FTE': round(sbs_data['112']['fte'], 1),
            'BE_SBS_113_FT': int(sbs_data['113']['full']),
            'BE_SBS_113_PT': int(sbs_data['113']['part']),
            'BE_SBS_113_FTE': round(sbs_data['113']['fte'], 1),
            'BE_SBS_120_FT': int(sbs_data['120']['full']),
            'BE_SBS_120_PT': int(sbs_data['120']['part']),
            'BE_SBS_120_FTE': round(sbs_data['120']['fte'], 1),
            'BE_SBS_1200_FT': int(sbs_data['1200']['full']),
            'BE_SBS_1200_PT': int(sbs_data['1200']['part']),
            'BE_SBS_1200_FTE': round(sbs_data['1200']['fte'], 1),
            'BE_SBS_1201_FT': int(sbs_data['1201']['full']),
            'BE_SBS_1201_PT': int(sbs_data['1201']['part']),
            'BE_SBS_1201_FTE': round(sbs_data['1201']['fte'], 1),
            'BE_SBS_1202_FT': int(sbs_data['1202']['full']),
            'BE_SBS_1202_PT': int(sbs_data['1202']['part']),
            'BE_SBS_1202_FTE': round(sbs_data['1202']['fte'], 1),
            'BE_SBS_1203_FT': int(sbs_data['1203']['full']),
            'BE_SBS_1203_PT': int(sbs_data['1203']['part']),
            'BE_SBS_1203_FTE': round(sbs_data['1203']['fte'], 1),
            'BE_SBS_121_FT': int(sbs_data['121']['full']),
            'BE_SBS_121_PT': int(sbs_data['121']['part']),
            'BE_SBS_121_FTE': round(sbs_data['121']['fte'], 1),
            'BE_SBS_1210_FT': int(sbs_data['1210']['full']),
            'BE_SBS_1210_PT': int(sbs_data['1210']['part']),
            'BE_SBS_1210_FTE': round(sbs_data['1210']['fte'], 1),
            'BE_SBS_1211_FT': int(sbs_data['1211']['full']),
            'BE_SBS_1211_PT': int(sbs_data['1211']['part']),
            'BE_SBS_1211_FTE': round(sbs_data['1211']['fte'], 1),
            'BE_SBS_1212_FT': int(sbs_data['1212']['full']),
            'BE_SBS_1212_PT': int(sbs_data['1212']['part']),
            'BE_SBS_1212_FTE': round(sbs_data['1212']['fte'], 1),
            'BE_SBS_1213_FT': int(sbs_data['1213']['full']),
            'BE_SBS_1213_PT': int(sbs_data['1213']['part']),
            'BE_SBS_1213_FTE': round(sbs_data['1213']['fte'], 1),
            'BE_SBS_130_FT': int(sbs_data['130']['full']),
            'BE_SBS_130_PT': int(sbs_data['130']['part']),
            'BE_SBS_130_FTE': round(sbs_data['130']['fte'], 1),
            'BE_SBS_134_FT': int(sbs_data['134']['full']),
            'BE_SBS_134_PT': int(sbs_data['134']['part']),
            'BE_SBS_134_FTE': round(sbs_data['134']['fte'], 1),
            'BE_SBS_132_FT': int(sbs_data['132']['full']),
            'BE_SBS_132_PT': int(sbs_data['132']['part']),
            'BE_SBS_132_FTE': round(sbs_data['132']['fte'], 1),
            'BE_SBS_133_FT': int(sbs_data['133']['full']),
            'BE_SBS_133_PT': int(sbs_data['133']['part']),
            'BE_SBS_133_FTE': round(sbs_data['133']['fte'], 1),
            'BE_SBS_205_FT': int(sbs_data['205']['full']),
            'BE_SBS_205_PT': int(sbs_data['205']['part']),
            'BE_SBS_205_FTE': round(sbs_data['205']['fte'], 1),
            'BE_SBS_305_FT': int(sbs_data['305']['full']),
            'BE_SBS_305_PT': int(sbs_data['305']['part']),
            'BE_SBS_305_FTE': round(sbs_data['305']['fte'], 1),
            'BE_SBS_5801': int(sbs_data['5801']),
            'BE_SBS_5811': int(sbs_data['5811']),
            'BE_SBS_5802': int(sbs_data['5802']),
            'BE_SBS_5812': int(sbs_data['5812']),
            'BE_SBS_5803': round(sbs_data['5803'], 2),
            'BE_SBS_5813': round(sbs_data['5813'], 2),
            'BE_SBS_58031': round(sbs_data['58031'], 2),
            'BE_SBS_58131': round(sbs_data['58131'], 2),
            'BE_SBS_58032': round(sbs_data['58032'], 2),
            'BE_SBS_58132': round(sbs_data['58132'], 2),
            'BE_SBS_58033': round(sbs_data['58033'], 2),
            'BE_SBS_58133': round(sbs_data['58133'], 2),
            'BE_SBS_5821': int(sbs_data['5821']),
            'BE_SBS_5831': int(sbs_data['5831']),
            'BE_SBS_5822': int(sbs_data['5822']),
            'BE_SBS_5832': int(sbs_data['5832']),
            'BE_SBS_5823': round(sbs_data['5823'], 2),
            'BE_SBS_5833': round(sbs_data['5833'], 2),
            'BE_SBS_5841': int(sbs_data['5841']),
            'BE_SBS_5851': int(sbs_data['5851']),
            'BE_SBS_5842': int(sbs_data['5842']),
            'BE_SBS_5852': int(sbs_data['5852']),
            'BE_SBS_5843': round(sbs_data['5843'], 2),
            'BE_SBS_5853': round(sbs_data['5853'], 2),
        }

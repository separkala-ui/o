<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_employee_form" model="ir.ui.view">
        <field name="name">hr.employee.form.inherit.l10n_au_hr_payroll</field>
        <field name="model">hr.employee</field>
        <field name="priority" eval="110"/>
        <field name="inherit_id" ref="hr.view_employee_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="after">
                <div
                    class="alert alert-warning mb-0" role="alert"
                    invisible="not super_account_warning or country_code != 'AU'" groups="hr_payroll.group_hr_payroll_user">
                    <field name="super_account_warning"/>
                </div>
            </xpath>
            <field name="legal_name" position="after">
                <field name='l10n_au_other_names' invisible="country_code != 'AU'"/>
            </field>
            <div name="hourly_wage" position="after">
                <field name="l10n_au_casual_loading"
                    class="o_hr_narrow_field" widget="percentage"
                    invisible="country_code != 'AU' or wage_type == 'monthly'"/>
            </div>
            <div name="wage" position="after">
                <field name="l10n_au_yearly_wage" invisible="country_code != 'AU'"/>
            </div>
            <group name="payroll_group" position="inside">
                <group name="l10n_au_general" string="General" invisible="country_code != 'AU'">
                    <field name="l10n_au_pay_day"/>
                    <field name="l10n_au_cessation_type_code" invisible="not contract_date_end"/>

                    <separator string="Personal Information"/>
                    <field name="is_non_resident"/>
                    <field name="l10n_au_tax_free_threshold" invisible="is_non_resident"/>
                    <field name="l10n_au_tfn_declaration"/>
                    <field name="l10n_au_tfn"
                        readonly="l10n_au_tfn_declaration != 'provided'"
                        required="l10n_au_tfn_declaration == 'provided'"
                        placeholder="141592653"/>
                    <field name="l10n_au_abn" invisible="l10n_au_tax_treatment_category != 'V'"/>
                    <field name="l10n_au_previous_payroll_id" groups="base.group_no_one"/>
                    <field name="l10n_au_payroll_id" groups="base.group_no_one"/>

                    <separator string="Tax and Contributions"/>
                    <field name="l10n_au_employment_basis_code"/>
                    <field name="l10n_au_income_stream_type"/>
                    <field name="l10n_au_work_country_id" invisible="l10n_au_income_stream_type != 'FEI'"/>
                    <field name="l10n_au_tax_treatment_category"/>
                    <field name="l10n_au_tax_treatment_option_actor"
                        invisible="l10n_au_tax_treatment_category != 'A'"
                        required="l10n_au_tax_treatment_category == 'A'"/>
                    <field name="l10n_au_less_than_3_performance"
                        invisible="l10n_au_tax_treatment_category != 'A' or l10n_au_tax_treatment_option_actor != 'D'"/>
                    <field name="l10n_au_tax_treatment_option_voluntary"
                        invisible="l10n_au_tax_treatment_category != 'V'"
                        required="l10n_au_tax_treatment_category == 'V'"/>
                    <field name="l10n_au_tax_treatment_option_seniors"
                        invisible="l10n_au_tax_treatment_category != 'S'"
                        required="l10n_au_tax_treatment_category == 'S'"/>
                    <field name="l10n_au_comissioners_installment_rate"
                        invisible="l10n_au_tax_treatment_category != 'V' or l10n_au_tax_treatment_option_voluntary != 'C'"/>
                    <div class="row text-danger" colspan="2" invisible="l10n_au_tax_treatment_category != 'V' or l10n_au_tax_treatment_option_voluntary != 'C' or l10n_au_comissioners_installment_rate != 0">
                        <span>
                            <p>The commissioner's instalment rate cannot be 0%. 20% will be applied instead.</p>
                        </span>
                    </div>
                    <field name="l10n_au_training_loan"/>
                    <field name="l10n_au_medicare_variation_form" filename="l10n_au_medicare_variation_form_filename" widget="binary" invisible="l10n_au_employment_basis_code == 'C'"/>
                    <field name="l10n_au_medicare_surcharge" invisible="not l10n_au_medicare_variation_form or l10n_au_employment_basis_code == 'C'"/>
                    <field name="l10n_au_medicare_exemption" invisible="not l10n_au_medicare_variation_form or not l10n_au_tax_free_threshold or l10n_au_employment_basis_code == 'C'"/>
                    <field name="l10n_au_medicare_reduction" invisible="not l10n_au_tax_free_threshold or not l10n_au_medicare_variation_form or l10n_au_employment_basis_code == 'C'"/>
                    <field name="l10n_au_tax_treatment_code" groups="base.group_no_one"/>
                </group>
                <group name="l10n_au_deductions" string="Deductions, offsets and withholding" invisible="country_code != 'AU'">
                    <field name="l10n_au_child_support_deduction"/>
                    <field name="l10n_au_child_support_garnishee_amount" widget="percentage"/>
                    <field name="l10n_au_nat_3093_amount"
                        invisible="(l10n_au_tax_treatment_category != 'R' or not l10n_au_tax_free_threshold) and l10n_au_tax_treatment_category != 'S'"/>
                    <field name="l10n_au_extra_pay"/>
                    <label for="l10n_au_withholding_variation"/>
                    <div class="d-flex align-items-baseline">
                        <field name="l10n_au_withholding_variation" nolabel="1" class="oe_inline"/>
                        <field name="l10n_au_withholding_variation_amount"
                            invisible="l10n_au_withholding_variation == 'none'" nolabel="1"
                            widget="float" class="oe_inline o_input_6ch"/>
                        <span invisible="l10n_au_withholding_variation == 'none'" class="opacity-50 p-2"> %</span>
                    </div>
                    <field name="l10n_au_additional_withholding_amount"/>
                </group>
                <group name="tax_treatment" string="Tax Treatment" invisible="country_code != 'AU' or l10n_au_tax_treatment_category != 'A'" groups="hr.group_hr_user">
                    <field name="l10n_au_performances_per_week" />
                </group>
                <group name="l10n_au_leave_loading" string="Leave Loading / Workplace Giving"
                    invisible="country_code != 'AU'">
                    <field name="l10n_au_eligible_for_leave_loading"/>
                    <field name="l10n_au_leave_loading" invisible="not l10n_au_eligible_for_leave_loading"/>
                    <field name="l10n_au_leave_loading_leave_types" invisible="not l10n_au_eligible_for_leave_loading or l10n_au_leave_loading != 'once'">
                        <list editable="bottom">
                            <field name="display_name"/>
                            <field name="work_entry_type_id"/>
                        </list>
                    </field>
                    <field name="l10n_au_leave_loading_rate" invisible="not l10n_au_eligible_for_leave_loading or not l10n_au_leave_loading"/>
                    <field name="l10n_au_workplace_giving" />
                    <field name="l10n_au_workplace_giving_employer" />
                </group>
                <group name="l10n_au_super_contributions" string="Super Contributions" invisible="country_code != 'AU'">
                    <field name="l10n_au_extra_negotiated_super" widget="percentage"/>
                    <field name="l10n_au_extra_compulsory_super" widget="percentage"/>
                </group>
                <group name="salary_sacrifice" string="Salary Sacrifice" invisible="country_code != 'AU'">
                    <field name="l10n_au_salary_sacrifice_superannuation"/>
                    <field name="l10n_au_salary_sacrifice_other"/>
                </group>
            </group>
            <page name="payroll_information" position="after">
                <page name="super_accounts" string="Super Accounts" invisible="country_code != 'AU'" groups="hr.group_hr_user">
                    <field name="l10n_au_super_account_ids">
                        <list>
                            <field name="fund_id"/>
                            <field name="fund_type"/>
                            <field name="date_from"/>
                            <field name="account_active" widget="boolean_toggle"/>
                            <field name="proportion" widget="percentage" optional="hide"/>
                        </list>
                    </field>
                </page>
            </page>
        </field>
    </record>
</odoo>
